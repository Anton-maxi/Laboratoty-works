#Перетворіть словник, створений у практичній роботі №5, на датафрейм. За потреби доповніть словник новими даними
# (наприклад, додайте ще кілька записів або стовпців із додатковими характеристиками об’єктів), виведіть вміст словника на екран.
# Виконайте базовий аналіз даних:
# Виведіть перші 3 рядки DataFrame (df.head(3)).
# Перевірте типи даних (df.dtypes).
# Визначте кількість рядків і стовпців (df.shape).
# Отримайте описову статистику (df.describe())

#Додайте новий стовпець, який буде містити розрахункові значення. Наприклад, обчисліть загальну вартість продажу товару для кожного запису.
# Виконайте фільтрацію даних, наприклад, виберіть товари з ціною понад 10 000 грн. Виконайте сортування даних, наприклад, за спаданням ціни або кількості.
#Виконайте групування даних та знайдіть середнє значення.
#Виконайте додаткові операції агрегації, наприклад:
# знайдіть максимальну суму продажів у категорії;
# визначте кількість унікальних товарів.


import pandas as pd
# показати всі колонки
pd.set_option('display.max_columns', None)

# показати всі рядки
pd.set_option('display.max_rows', None)
#Відключаєм перенос у виводі дата фрейму
pd.options.display.expand_frame_repr = False


name = [
    'Андрій Коваленко Сергійович', 'Марія Шевченко Олександрівна',
    'Олег Бондаренко Ігорович','Ірина Мельник Василівна',
    'Дмитро Савченко Петрович','Оксана Лисенко Андріївна',
    'Володимир Гриценко Михайлович','Наталія Романюк Степанівна',
    'Тарас Дорошенко Юрійович','Катерина Сидоренко Вікторівна'
]

height = [172, 165, 178, 160, 181, 168, 185, 162, 176, 170]
#Додамо ще кілька рядків для подальшої її обробки
subjects= ['Програмування мовою С','Програмування мовою Python','Чисельні методи дослідження операцій']
grade_subject= [[72, 85, 64, 90, 48, 100, 77, 59, 83, 68],
                [88, 74, 92, 65, 53, 79, 100, 47, 81, 69],
                [56, 83, 71, 95, 62, 40, 78, 89, 67, 84]]

# Формуємо з цього всього словник
students = {
    n: {
        "Зріст": h,
        **{subj: grades[i] for subj, grades in zip(subjects, grade_subject)}
    }
    for i, (n, h) in enumerate(zip(name, height))
}


# Створюємо датафрейм
df = pd.DataFrame.from_dict(students, orient="index")

print(df)

print('\nВивід перших трьох рядків дата-фрейму:\n')
print(df.head(3))
print('\nТипи даних в дата фреймі:\n')
print(df.dtypes)

shape= df.shape

print(f"\nРядків: {shape[0]}, Колонок із значеннями: {shape[1]}")

print("\nОписова статистика дата - фрейму:\n")
analysing=df.describe()

# Перейменування рядків індексу
analysing = analysing.rename(index={
    "count": "Кількість",
    "mean": "Середнє",
    "std": "Відхилення",
    "min": "Мінімум",
    "25%": "25-й перцентиль",
    "50%": "Медіана",
    "75%": "75-й перцентиль",
    "max": "Максимум"
})
print(analysing)

# 1. Новий стовпець: сума оцінок
df['Сума оцінок'] = df[subjects].sum(axis=1)

# 2. Фільтрація: студенти з сумою оцінок понад 240
filtered_df = df[df['Сума оцінок'] > 240]
print("\nСтуденти з сумою оцінок понад 240:\n")
print(filtered_df)

# 3. Сортування за спаданням суми оцінок
sorted_df = df.sort_values(by='Сума оцінок', ascending=False)
print("\nСортування за спаданням суми оцінок:\n")
print(sorted_df)

# 4. Групування: середній зріст по категорії (чи сума оцінок > 240)
df['Сума оцінок > 240'] = df['Сума оцінок'] > 240
grouped = df.groupby('Сума оцінок > 240')['Зріст'].mean()
print("\nСередній зріст групи учнів залежачи від їхніх сум оцінок):\n")
grouped = grouped.rename(index={
    False: "Середній зріст групи учнів в яких сума їхніх оцінок менша за 240:",
    True: "Середній зріст групи учнів в яких сума їхніх оцінок більша за 240:",
})
print(grouped)

# 5. Додаткові агрегації
max_sum = df['Сума оцінок'].max()
print(f"\nМаксимальна сума оцінок: {max_sum}")

# 6. Знаходимо середній бал по кожному предмету
mean_per_subject = df[subjects].mean()
print("\nСередній бал по кожному предмету:\n")
print(mean_per_subject)

# 7. Додаємо новий стовпець – середній бал студента
df['Середній бал'] = df[subjects].mean(axis=1)
print("\nДатафрейм із середнім балом:\n")
print(df)

# 8. Знаходимо студента з найвищим середнім балом
best_student = df['Середній бал'].idxmax()
print(f"\nСтудент з найвищим середнім балом: {best_student}")
# 9. Вибірка студентів із середнім балом вище 80
high_avg = df[df['Середній бал'] > 80]
print("\nСтуденти із середнім балом > 80:\n")
print(high_avg)
